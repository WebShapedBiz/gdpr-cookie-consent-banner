{"version":3,"sources":["webpack:///./components/consent2/index.js","webpack:///./components/consent2/style.scss","webpack:///../lib/accessibility.js","webpack:///../lib/cookie.js","webpack:///../lib/consent.js","webpack:///../lib/index.js"],"names":["Banner","id","className","style","banner","aria-label","role","htmlFor","type","name","checked","disabled","Notice","src","alt","Consent2","useEffect","window","consent2","CookieConsent","document","getElementById","notice","capabilities","onAccept","consent","console","log","choices","getChoices","saveUserOptions","consented","onReject","cookieService","findCookie","clearCookies","expires","Date","head","getElementsByTagName","script","createElement","async","onload","gtag","dataLayer","push","arguments","anonymize_ip","appendChild","key","module","exports","prefersReducedMotion","matchMedia","matches","getCookie","withName","value","cookie","split","pop","shift","includes","JSON","parse","getAllCookies","map","str","setCookie","andValue","andOptions","options","stringify","createCookieString","cookieDefaults","removeCookie","path","getExpirationDate","expiringDays","expireDate","setTime","getTime","withOptions","Object","keys","join","CookieService","thatMatch","allCookies","regex","RegExp","find","test","forEach","match","Event","ON_UPDATE","ON_VALUE_CHANGED","ON_ACCEPT","ON_REJECT","defaultOptions","debug","removeUserOptions","location","reload","this","queue","button","reject","querySelector","accept","initEvents","content","loadUserOptions","setChoices","initStartUpEvents","initFields","showElement","error","addEventListener","time","choice","capability","getCapability","_runValueEventsFor","_runEventFor","_startRunner","timeEnd","hideElement","setTimeout","saveThis","newContent","getChoice","byName","querySelectorAll","node","getAttribute","replace","c","element","animate","opacity","duration","iterations","onFinish","classList","add","removeEventListener","remove","_addToQueue","func","values","event","filter","q","withEvent","params","Function","info","warn","withChoice","userOptions"],"mappings":"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","file":"4.chunk.b42cd.js","sourcesContent":["import { h } from 'preact'\nimport { useEffect } from 'preact/hooks'\nimport CookieConsent from '../../../lib'\n\nimport style from './style.scss'\n\nconst Banner = () => (\n  <div\n    id=\"cookiebanner2\"\n    className={`cookiebanner ${style.banner}`}\n    aria-label=\"Edit your cookie settings\"\n    role=\"banner\"\n  >\n    <div className=\"info\">\n      <div className=\"title\">Your Cookie Controls</div>\n      <div className=\"description\">Paste some info for your users here.</div>\n    </div>\n    <div className=\"choices\">\n      <label className=\"choice\" htmlFor=\"choice-functional\">\n        <input\n          type=\"checkbox\"\n          name=\"choice:functional\"\n          id=\"choice-functional\"\n          checked\n          disabled\n        />\n        <div className=\"name\">Functional with a very long long long long long</div>\n      </label>\n      <label className=\"choice\" htmlFor=\"choice-analytics\">\n        <input type=\"checkbox\" name=\"choice:analytics\" id=\"choice-analytics\" />\n        <div className=\"name\">Analytics</div>\n        <p className=\"info\">Google Tag Manager will be enabled here.</p>\n      </label>\n    </div>\n    <div className=\"buttons\">\n      <button className=\"reject\">Reject choices</button>\n      <button className=\"accept\">Accept choices</button>\n    </div>\n  </div>\n)\n\nconst Notice = () => (\n  <div\n    id=\"cookienotice2\"\n    className={`cookienotice ${style.banner}`}\n    aria-label=\"Show the cookie settings again\"\n    role=\"button\"\n  >\n    <img src=\"/assets/cookie.svg\" alt=\"A shield which represents privacy\" />\n  </div>\n)\n\nconst Consent2 = () => {\n  useEffect(() => {\n    window.consent2 = new CookieConsent({\n      name: 'consent-with-ga',\n      banner: document.getElementById('cookiebanner2'),\n      notice: document.getElementById('cookienotice2'),\n      capabilities: [\n        {\n          name: 'functional',\n          checked: true,\n          onAccept: (consent) => {\n            console.log('[functional2:onAccept]')\n            const choices = consent.getChoices()\n            consent.saveUserOptions({ choices, consented: true })\n          },\n        },\n        {\n          name: 'analytics',\n          checked: false,\n          onReject: () => {\n            console.log('[analytics:onReject]')\n            if (CookieConsent.cookieService.findCookie('_g')) {\n              CookieConsent.cookieService.clearCookies('_g', {\n                expires: new Date('1996-06-13'),\n              })\n            }\n          },\n          onAccept: () => {\n            console.log('[analytics:onAccept]')\n            const head = document.getElementsByTagName('head')[0]\n            const script = document.createElement('script')\n            script.src = 'https://www.googletagmanager.com/gtag/js?id=UA-156811148-1'\n            script.async = true\n            script.onload = () => {\n              window.dataLayer = window.dataLayer || []\n              function gtag() {\n                window.dataLayer.push(arguments)\n              }\n              gtag('js', new Date())\n              gtag('config', 'UA-156811148-1', {\n                anonymize_ip: true,\n              })\n            }\n            head.appendChild(script)\n          },\n        },\n      ],\n    })\n  })\n\n  return [<Banner key=\"banner\" />, <Notice key=\"notice\" />]\n}\n\nexport default Consent2\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"banner\":\"banner__1f7Hi\"};","/**\n * The browser user prefers to have reduced motion.\n */\nexport const DETECT_REDUCED_MOTION = '(prefers-reduced-motion)'\nexport function prefersReducedMotion() {\n  return window.matchMedia(DETECT_REDUCED_MOTION).matches\n}\n\n/**\n * User prefers to have a dark appearance.\n */\nexport const DETECT_COLOR_SCHEME_DARK = '(prefers-color-scheme: dark)'\nexport function prefersDarkAppearance() {\n  return window.matchMedia(DETECT_COLOR_SCHEME_DARK).matches\n}\n\n/**\n * User prefers to have a light appearance.\n */\nexport const DETECT_COLOR_SCHEME_LIGHT = '(prefers-color-scheme: light)'\nexport function prefersLightAppearance() {\n  return window.matchMedia(DETECT_COLOR_SCHEME_LIGHT).matches\n}\n\n/**\n * User prefers to have high contrasts.\n *\n * @deprecated https://developer.mozilla.org/en-US/docs/Web/CSS/@media/-ms-high-contrast\n */\nexport const DETECT_HIGH_CONTRAST = '(-ms-high-contrast: active)'\nexport function prefersHighContrast() {\n  return window.matchMedia(DETECT_HIGH_CONTRAST).matches\n}\n","const cookieDefaults = {\n  expires: getExpirationDate(),\n  path: '/',\n}\n\nfunction getCookie(withName) {\n  const value = ('; ' + document.cookie)\n    .split(`; ${withName}=`)\n    .pop()\n    .split(';')\n    .shift()\n  if (!value || value === 'undefined') {\n    return undefined\n  } else if (['true', 'false'].includes(value)) {\n    return value === 'true'\n  }\n  return JSON.parse(value)\n}\n\nfunction getAllCookies() {\n  const strings = document.cookie.split('; ')\n  const cookies = strings.map((str) => {\n    const [key, value] = str.split('=')\n    return { key, value }\n  })\n  return cookies\n}\n\nfunction setCookie(withName, andValue, andOptions) {\n  let options = {}\n  options[withName] = JSON.stringify(andValue)\n  options = { ...options, ...cookieDefaults, ...andOptions }\n  options = createCookieString(options)\n  document.cookie = options\n}\n\nfunction removeCookie(withName, andOptions) {\n  let options = {}\n  options[withName] = ''\n  options['max-age'] = 0\n  options.path = cookieDefaults.path\n  options = { ...options, ...andOptions }\n  options.expires = new Date('1996-06-13')\n  options = createCookieString(options)\n  setCookie(withName, options)\n}\n\nfunction clearCookies(thatMatch, withOptions) {\n  const allCookies = getAllCookies()\n  const regex = new RegExp(`^${thatMatch}`, 'g')\n  allCookies.forEach(({ key }) => {\n    if (key.match(regex)) {\n      removeCookie(key, withOptions)\n    }\n  })\n}\n\nfunction findCookie(thatMatch) {\n  const allCookies = getAllCookies()\n  const regex = new RegExp(`^${thatMatch}`, 'g')\n  const cookie = allCookies.find(({ key }) => regex.test(key))\n  return cookie || null\n}\n\nfunction getExpirationDate(expiringDays = 365) {\n  const expireDate = new Date()\n  expireDate.setTime(expireDate.getTime() + expiringDays * 24 * 60 * 60 * 1000)\n  return expireDate\n}\n\nfunction createCookieString(withOptions) {\n  return Object.keys(withOptions)\n    .map((key) => `${key}=${withOptions[key]}`)\n    .join('; ')\n}\n\nexport { getCookie, getAllCookies, setCookie, removeCookie, findCookie, clearCookies }\nconst CookieService = {\n  getCookie,\n  getAllCookies,\n  setCookie,\n  removeCookie,\n  findCookie,\n  clearCookies,\n  getExpirationDate,\n}\nexport default CookieService\n","import { prefersReducedMotion } from './accessibility'\nimport { getCookie, setCookie, removeCookie } from './cookie'\n\nconst Event = {\n  ON_UPDATE: 'onUpdate',\n  ON_VALUE_CHANGED: 'onValueChange',\n  ON_ACCEPT: 'onAccept',\n  ON_REJECT: 'onReject',\n}\n\nexport default class CookieConsent {\n  constructor(options) {\n    const defaultOptions = {\n      debug: false,\n      name: 'cookie-consent',\n      banner: document.getElementById('cookiebanner'),\n      notice: document.getElementById('cookienotice'),\n      capabilities: [\n        {\n          name: 'functional',\n          checked: true,\n          onReject: (consent) => {\n            consent.removeUserOptions()\n            window.location.reload()\n          },\n          onAccept: (consent) => {\n            const choices = consent.getChoices()\n            consent.saveUserOptions({ choices, consented: true })\n          },\n        },\n      ],\n    }\n\n    this.options = { ...defaultOptions, ...options }\n    this.queue = [] // this will hold event hooks to run in order\n\n    // console.log(this.options)\n\n    if (!this.options.banner || !this.options.notice) {\n      console.error('Can not find required elements!')\n      return // no banner or notice present\n    }\n\n    this.button = {}\n    this.button.reject = this.options.banner.querySelector('.reject')\n    this.button.accept = this.options.banner.querySelector('.accept')\n\n    if (!this.button.reject || !this.button.accept) {\n      console.error('Can not find required buttons!')\n      return undefined // no buttons present\n    }\n\n    this.initEvents()\n\n    const content = this.loadUserOptions()\n\n    // console.log(JSON.stringify(content, null, 2))\n\n    if (content && content.choices) {\n      this.setChoices(content.choices)\n      this.initStartUpEvents()\n    } else {\n      this.initFields()\n    }\n\n    if (content && content.consented) {\n      this.showElement(this.options.notice)\n    } else {\n      this.showElement(this.options.banner)\n    }\n  }\n\n  /**\n   * Sync form input fields with capabilities .\n   *\n   * @returns {Choice[]} passed choices\n   */\n  initFields() {\n    const choices = this.options.capabilities.map(({ name, checked }) => ({\n      name: name,\n      value: checked,\n    }))\n    this.setChoices(choices)\n    return choices\n  }\n\n  /**\n   * Initial all element events.\n   */\n  initEvents() {\n    // Reject\n    this.button.reject.addEventListener('click', () => {\n      if (this.options.debug) console.time('reject')\n      const choices = this.initFields()\n      choices.forEach((choice) => {\n        const capability = this.getCapability(choice.name)\n        this._runValueEventsFor(capability, choice)\n        this._runEventFor(capability, Event.ON_REJECT)\n      })\n      this._startRunner()\n      if (this.options.debug) console.timeEnd('reject')\n      this.hideElement(this.options.banner)\n      setTimeout(() => {\n        this.showElement(this.options.notice)\n      }, 160)\n    })\n\n    // Accept\n    this.button.accept.addEventListener('click', () => {\n      if (this.options.debug) console.time('accept')\n      const choices = this.getChoices()\n      choices.forEach((choice) => {\n        const capability = this.getCapability(choice.name)\n        this._runValueEventsFor(capability, choice)\n        this._runEventFor(capability, Event.ON_ACCEPT)\n      })\n      this._startRunner()\n      if (this.options.debug) console.timeEnd('accept')\n      this.hideElement(this.options.banner)\n      setTimeout(() => {\n        this.showElement(this.options.notice)\n      }, 160)\n    })\n\n    // Show banner\n    this.options.notice.addEventListener('click', () => {\n      this.hideElement(this.options.notice)\n      this.showElement(this.options.banner)\n    })\n  }\n\n  /**\n   * On first load fire these events.\n   */\n  initStartUpEvents() {\n    const choices = this.getChoices()\n    choices.forEach((choice) => {\n      const capability = this.getCapability(choice.name)\n      if (choice.value) {\n        // is checked\n        this._runEventFor(capability, Event.ON_ACCEPT)\n      } else {\n        this._runEventFor(capability, Event.ON_REJECT)\n      }\n      this._startRunner()\n    })\n  }\n\n  /**\n   * Get our plugin options cookies content.\n   */\n  loadUserOptions() {\n    const content = getCookie(this.options.name)\n    if (!content) return null\n    return content\n  }\n\n  /**\n   * Save something to our plugin options cookie.\n   *\n   * @param {object} saveThis\n   */\n  saveUserOptions(saveThis) {\n    const oldContent = getCookie(this.options.name)\n    const newContent = { ...oldContent, ...saveThis }\n    setCookie(this.options.name, newContent)\n  }\n\n  /**\n   * Delete all plugin options that are saved into a cookie.\n   */\n  removeUserOptions() {\n    if (getCookie(this.options.name)) {\n      removeCookie(this.options.name)\n    }\n  }\n\n  /**\n   * Get single form input choice by its input name.\n   *\n   * @param {string} byName\n   */\n  getChoice(byName) {\n    const node = this.options.banner.querySelector(`.choice [name=\"choice:${byName}\"]`)\n\n    return node.checked\n  }\n\n  /**\n   * Get form input choices.\n   */\n  getChoices() {\n    let choices = []\n\n    this.options.banner.querySelectorAll('.choice input').forEach((node) => {\n      const name = node.getAttribute('name').replace('choice:', '')\n      const value = node.checked\n      choices.push({ name, value })\n    })\n\n    return choices\n  }\n\n  /**\n   * Set form input choices. Most likely for reseting the form.\n   *\n   * @param {Choice[]} choices\n   */\n  setChoices(choices) {\n    this.options.banner.querySelectorAll('.choice input').forEach((node) => {\n      const name = node.getAttribute('name').replace('choice:', '')\n      const choice = choices.find((c) => c.name === name)\n      if (choice) {\n        node.checked = choice.value\n      }\n    })\n  }\n\n  /**\n   * Get capability by name.\n   *\n   * @param {string} name\n   */\n  getCapability(name) {\n    return this.options.capabilities.find((c) => c.name === name)\n  }\n\n  /**\n   * Smoothly show an element.\n   *\n   * @param {HTMLElement} element\n   */\n  showElement(element) {\n    if ('animate' in element && !prefersReducedMotion()) {\n      element\n        .animate([{ opacity: 0 }, { opacity: 1 }], {\n          duration: 320,\n          iterations: 1,\n        })\n        .addEventListener('finish', function onFinish() {\n          element.classList.add('visible')\n          element.removeEventListener('finish', onFinish)\n        })\n    } else {\n      element.classList.add('visible')\n    }\n  }\n\n  /**\n   * Smoothly hide an element.\n   *\n   * @param {HTMLElement} element\n   */\n  hideElement(element) {\n    if ('animate' in element && !prefersReducedMotion()) {\n      element\n        .animate([{ opacity: 1 }, { opacity: 0 }], {\n          duration: 160,\n          iterations: 1,\n        })\n        .addEventListener('finish', function onFinish() {\n          element.classList.remove('visible')\n          element.removeEventListener('finish', onFinish)\n        })\n    } else {\n      element.classList.remove('visible')\n    }\n  }\n\n  /**\n   * Add a callable event function to an queue.\n   *\n   * @param {string} name\n   * @param {function} func\n   */\n  _addToQueue(name, func) {\n    this.queue.push({ name, func })\n  }\n\n  /**\n   * Run the callable event queue.\n   */\n  _startRunner() {\n    // loop event by order\n    Object.values(Event).forEach((event) => {\n      // find callables from queue with event name\n      const callables = this.queue.filter((q) => q.name === event)\n      // call them\n      callables.forEach(({ func }) => func())\n    })\n    this.queue = [] // clear queue for new operations\n  }\n\n  /**\n   * Run one event for one capability.\n   *\n   * @param {Capability} capability\n   * @param {Event} withEvent\n   * @param {object} params\n   */\n  _runEventFor(capability, withEvent, params = {}) {\n    if (\n      capability &&\n      withEvent &&\n      capability[withEvent] &&\n      capability[withEvent] instanceof Function\n    ) {\n      this._addToQueue(withEvent, () => capability[withEvent](this, params))\n      if (this.options.debug) {\n        console.info(`[CookieConsent]: Added ${capability.name}.${withEvent} to queue`)\n      }\n    } else {\n      if (this.options.debug) {\n        console.warn(\n          `[CookieConsent]: Capability ${capability.name} has no event of name ${withEvent}`\n        )\n      }\n    }\n  }\n\n  /**\n   * Run common or value change/update events for one capability.\n   *\n   * @param {Capability} capability\n   * @param {Choice} withChoice\n   */\n  _runValueEventsFor(capability, withChoice) {\n    let params = {\n      choice: withChoice.value,\n    }\n\n    // on input value update\n    this._runEventFor(capability, Event.ON_UPDATE, params)\n\n    // on input value change\n    const userOptions = this.loadUserOptions()\n    // load saved cookie options choices if present\n    if (userOptions?.choices) {\n      // find current choice in saved choices\n      const choice = userOptions.choices.find((c) => c.name === withChoice.name)\n      // check against input choice value\n      const hasChanged = withChoice.value !== choice.value\n      if (hasChanged) {\n        this._runEventFor(capability, Event.ON_VALUE_CHANGED, params)\n      }\n    }\n  }\n}\n","import CookieConsent from './consent'\nimport CookieService from './cookie'\n\nimport '../style.scss'\n\nCookieConsent.cookieService = CookieService\n\nexport default CookieConsent\n"],"sourceRoot":""}